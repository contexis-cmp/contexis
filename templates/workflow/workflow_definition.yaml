# Workflow Definition: {{ .Name }}
# Generated by CMP Framework on {{ .CreatedDate }}

name: "{{ .Name }}"
version: "{{ .Version }}"
description: "{{ .Description }}"
author: "{{ .Author }}"
created_date: "{{ .CreatedDate }}"
last_modified: "{{ .LastModified }}"

# Workflow Configuration
config:
  max_concurrency: {{ .MaxConcurrency }}
  retry_attempts: {{ .RetryAttempts }}
  retry_delay: {{ .RetryDelay }}
  timeout: {{ .Timeout }}
  state_persistence: {{ .StatePersistence }}
  error_handling: "{{ .ErrorHandling }}"
  logging: "{{ .Logging }}"
  monitoring: {{ .Monitoring }}

# Resource Limits
resources:
  cpu: "{{ .ResourceLimits.CPU }}"
  memory: "{{ .ResourceLimits.Memory }}"
  storage: "{{ .ResourceLimits.Storage }}"
  network: "{{ .ResourceLimits.Network }}"

# Workflow Steps
steps:
{{- range $index, $step := .StepsConfig }}
  - name: "{{ $step.Name }}"
    description: "{{ $step.Description }}"
    type: "{{ $step.Type }}"
    timeout: {{ $step.Timeout }}
    retry_attempts: {{ $step.RetryAttempts }}
    parallel: {{ $step.Parallel }}
    condition: "{{ $step.Condition }}"
    error_handling: "{{ $step.ErrorHandling }}"
    dependencies: {{ $step.Dependencies }}
    resources:
      cpu: "{{ $step.Resources.CPU }}"
      memory: "{{ $step.Resources.Memory }}"
      storage: "{{ $step.Resources.Storage }}"
      network: "{{ $step.Resources.Network }}"
    input: {{ $step.Input }}
    output: {{ $step.Output }}
{{- end }}

# Workflow Dependencies
dependencies:
{{- range $index, $step := .StepsConfig }}
  {{- if gt (len $step.Dependencies) 0 }}
  {{ $step.Name }}:
    {{- range $step.Dependencies }}
    - {{ . }}
    {{- end }}
  {{- end }}
{{- end }}

# Error Handling
error_handling:
  strategy: "{{ .ErrorHandling }}"
  retry_attempts: {{ .RetryAttempts }}
  retry_delay: {{ .RetryDelay }}
  continue_on_error: {{ if eq .ErrorHandling "continue_on_error" }}true{{ else }}false{{ end }}

# State Management
state_management:
  persistence: {{ .StatePersistence }}
  storage_path: "memory/{{ .Name }}/workflow_state"
  checkpoint_interval: 30
  cleanup_after_completion: true

# Monitoring and Logging
monitoring:
  enabled: {{ .Monitoring }}
  metrics_collection: true
  progress_tracking: true
  performance_monitoring: true
  alerting:
    enabled: true
    thresholds:
      timeout: {{ .Timeout }}
      error_rate: 0.1
      resource_usage: 0.8
